# 6. 功能排序与依赖

## 6.1. 功能依赖

| 顺序 | 工作项 | 阻断条件 | 验收门槛 | 负责人 |
| --- | --- | --- | --- | --- |
| 1 | 故事 1.1（数据模型与配置加载） | 未完成 DataKey/ExecutablePath 扩展，则混合匹配及 UI 迭代不得进入开发 | `GameConfig` 与 `YamlConfigProvider` 通过单元测试，并完成对旧 `config.yml` 的手动验证 | 架构负责人 |
| 2 | 故事 1.2（核心匹配逻辑） | 未合并 1.1 输出的模型改动，阻断服务层实现；FuzzySharp 依赖未还原 | `GameAutomationService` 新增单元测试通过，进程监控集成测试在 Windows 环境 green | 后端负责人 |
| 3 | 故事 1.3（CLI/交互式 UI） | 1.2 未完成导致缺少新的匹配结果事件；Steam 解析器未注册 | 交互式 Shell 手动脚本（参考 docs/history/CLI_Manual_zh.md）跑通，并通过 QA 验收清单 | CLI/体验负责人 |
| 4 | 故事 1.4（数据服务关联） | 1.2、1.3 未提供稳定的 DataKey 输出，无法验证 CSV 写入 | `CsvBackedPlayTimeService` 回归测试（含 CSV 初始化与数据追加）通过；`stats` 命令展示符合预期 | 数据负责人 |

> 备注：史诗以阻断链的形式推进，任何条目的验收失败会阻止后续故事进入开发阶段，直至责任人完成补救并更新依赖表。

## 6.2. 技术依赖与发布门槛

1.  **配置/模型先行**: 所有涉及混合匹配的代码变更必须在 `GameConfig` 与 `YamlConfigProvider` 更新合入主分支后才能启动，以避免旧配置在功能分支中产生破坏性差异。
2.  **监控服务与匹配逻辑联动**: 在 `ProcessMonitorFactory` 中启用新的匹配服务前，需要确认 ETW/WMI 路径均已运行 `dotnet test`，并在 Windows 环境下执行一次 `dotnet run -- monitor` 观察事件流是否按 L1/L2 顺序传递。
3.  **发布前置清单**:
    * 完成 `CsvBackedPlayTimeService` 的回归（见 10.3 节）并输出操作日志。
    * 由架构负责人出具“混合匹配发布”验收结论，确认配置、服务、UI、数据四条链路的依赖均已满足。
    * QA 负责人确认 CLI/交互式脚本的回归通过，才能触发 GitHub Release 工作流。
