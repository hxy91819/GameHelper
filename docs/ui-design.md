# GameHelper - Web UI 设计文档

本文档定义 GameHelper Web 前端的 UI 设计规范，技术栈为 Next.js App Router + TypeScript + Tailwind CSS + shadcn/ui + Recharts。

---

## 1. 设计原则

- **暗色优先**：游戏工具的用户习惯暗色主题，默认 Dark Mode，可切换 Light Mode
- **信息密度适中**：每个页面聚焦一个任务，避免仪表盘堆砌过多卡片
- **即时反馈**：所有写操作（增删改）通过 Toast 通知结果，乐观更新 UI
- **零学习成本**：遵循常见管理后台布局模式，左侧导航 + 右侧内容区

---

## 2. 色彩与主题

基于 shadcn/ui 的 CSS 变量系统：

| Token | Dark Mode | Light Mode | 用途 |
|---|---|---|---|
| `--background` | `#09090b` (zinc-950) | `#ffffff` | 页面背景 |
| `--card` | `#18181b` (zinc-900) | `#f4f4f5` | 卡片/面板背景 |
| `--primary` | `#6366f1` (indigo-500) | `#4f46e5` | 主操作按钮、高亮 |
| `--destructive` | `#ef4444` (red-500) | `#dc2626` | 删除按钮 |
| `--muted` | `#27272a` (zinc-800) | `#e4e4e7` | 次要背景、边框 |
| `--accent` | `#22c55e` (green-500) | `#16a34a` | 启用状态、HDR 开启 |

---

## 3. 整体布局

```
┌─────────────────────────────────────────────────────────────┐
│  ┌──────────┐                                               │
│  │          │  ┌──────────────────────────────────────────┐  │
│  │          │  │                                          │  │
│  │  Sidebar │  │              Main Content                │  │
│  │  (240px) │  │              (flex-1)                    │  │
│  │          │  │                                          │  │
│  │          │  │                                          │  │
│  │          │  │                                          │  │
│  │          │  └──────────────────────────────────────────┘  │
│  └──────────┘                                               │
└─────────────────────────────────────────────────────────────┘
```

### Sidebar 组件

```
┌────────────────────┐
│                    │
│  🎮 GameHelper     │  ← Logo + App Name (font-bold text-lg)
│                    │
│  ──────────────    │  ← Separator
│                    │
│  📊 仪表盘        │  ← NavLink (active: bg-accent/10 + left border)
│  🎯 游戏库        │
│  📈 统计          │
│  ⚙️ 设置          │
│                    │
│                    │
│                    │
│  ──────────────    │
│  🌙 暗色/亮色     │  ← Theme Toggle (底部)
│                    │
└────────────────────┘
```

**导航项组件**: `NavLink`
- 未选中: `text-muted-foreground hover:bg-muted`
- 选中: `bg-primary/10 text-primary border-l-2 border-primary`
- 图标使用 Lucide icons（`LayoutDashboard`, `Gamepad2`, `BarChart3`, `Settings`）

**移动端 (< 768px)**:
- Sidebar 隐藏，顶部出现 hamburger 按钮
- 点击后 Sidebar 作为 Sheet（shadcn/ui）从左侧滑出
- 内容区域使用 overlay 遮罩

---

## 4. 页面设计

### 4.1 仪表盘 (Dashboard) — `/`

首页，提供快速概览。

```
┌──────────────────────────────────────────────────────────┐
│  仪表盘                                                  │
│                                                          │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐ │
│  │ 🎮 监控游戏 │ │ ⏱ 总游戏时长│ │ 📅 近两周游戏时长   │ │
│  │             │ │             │ │                     │ │
│  │    12       │ │   486 小时  │ │    32 小时          │ │
│  │             │ │             │ │                     │ │
│  └─────────────┘ └─────────────┘ └─────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  近两周游戏时间分布 (BarChart)                       │ │
│  │                                                      │ │
│  │    ██                                                │ │
│  │    ██  ██                                            │ │
│  │    ██  ██  ██                                        │ │
│  │    ██  ██  ██  ██                                    │ │
│  │   ─────────────────                                  │ │
│  │   赛博  法环  星露  破晓                             │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  最近游玩                                            │ │
│  │                                                      │ │
│  │  🎮 赛博朋克2077        2小时30分  ·  今天 20:00    │ │
│  │  🎮 艾尔登法环          0小时45分  ·  今天 18:00    │ │
│  │  🎮 星露谷物语          5小时10分  ·  昨天 22:00    │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────┘
```

**组件细节**:

- **统计卡片**: 使用 shadcn `Card` 组件，3 列网格 (`grid grid-cols-3 gap-4`)
  - 标题: `text-sm text-muted-foreground`
  - 数值: `text-2xl font-bold`
  - 图标: Lucide icon 在标题左侧，`text-primary`
- **柱状图**: Recharts `<BarChart>` 组件
  - X 轴: 游戏名称（DisplayName）
  - Y 轴: 近两周游戏时长（小时）
  - Bar 颜色: `var(--primary)` 带圆角 `radius={4}`
  - Tooltip 显示精确时长
- **最近游玩列表**: 最近 5 条会话记录
  - 每行: 游戏图标 + 名称 | 持续时间（右对齐） | 相对时间（`text-muted-foreground`）
  - hover: `bg-muted/50` 行高亮
  - 点击跳转到该游戏的统计详情

### 4.2 游戏库 (Game Library) — `/games`

管理监控游戏列表。

```
┌──────────────────────────────────────────────────────────┐
│  游戏库                                   [+ 添加游戏]   │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ 🔍 搜索游戏...                                      │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  显示名称       │ 可执行文件     │ 监控  │ HDR │  ⋮  │ │
│  │─────────────────┼────────────────┼───────┼─────┼─────│ │
│  │  赛博朋克2077   │ cyberpunk.exe  │  ✅   │ ✅  │  ⋮  │ │
│  │  艾尔登法环     │ eldenring.exe  │  ✅   │ ❌  │  ⋮  │ │
│  │  星露谷物语     │ Stardew.exe    │  ❌   │ ❌  │  ⋮  │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                          │
│  ─── 空状态 (无游戏时) ───                               │
│  ┌──────────────────────────────────────────────────────┐ │
│  │                                                      │ │
│  │           🎮                                         │ │
│  │      还没有添加任何游戏                              │ │
│  │      点击上方「添加游戏」开始配置                    │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────┘
```

**组件细节**:

- **页面标题栏**: flex 布局，左侧标题 + 右侧 `Button` variant="default"
- **搜索框**: shadcn `Input` + Lucide `Search` icon prefix，实时过滤表格
- **游戏表格**: shadcn `Table` 组件
  - 列定义:
    - **显示名称**: `font-medium`，若为空则显示 DataKey
    - **可执行文件**: `text-muted-foreground font-mono text-sm`
    - **监控状态**: shadcn `Switch` 组件，直接切换触发 PUT 请求
    - **HDR**: shadcn `Switch` 组件，同上
    - **操作**: shadcn `DropdownMenu`（⋮ 图标触发），含「编辑」「删除」
  - Switch 切换时直接调用 API，无需额外确认（乐观更新 + Toast）

**添加/编辑游戏 Dialog**:

```
┌──────────────────────────────────┐
│  添加游戏                    ✕   │
│                                  │
│  显示名称                        │
│  ┌────────────────────────────┐  │
│  │ 赛博朋克2077              │  │
│  └────────────────────────────┘  │
│                                  │
│  可执行文件名 *                  │
│  ┌────────────────────────────┐  │
│  │ cyberpunk2077.exe          │  │
│  └────────────────────────────┘  │
│  ⚠ 请输入 .exe 文件名            │
│                                  │
│  可执行文件路径 (可选)           │
│  ┌────────────────────────────┐  │
│  │ D:\Games\Cyberpunk\...    │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌──────────────────┐            │
│  │ ✅ 启用监控      │            │
│  │ ❌ 启用 HDR      │            │
│  └──────────────────┘            │
│                                  │
│            [取消]    [保存]       │
└──────────────────────────────────┘
```

- shadcn `Dialog` + `DialogContent`
- 表单字段: `Input` + `Label` + 内联校验错误 (`text-destructive text-sm`)
- 开关: shadcn `Switch` + Label，水平排列
- 底部: `DialogFooter` 中两个 `Button`（取消 variant="outline"，保存 variant="default"）

**删除确认 Dialog**:

```
┌──────────────────────────────────┐
│  确认删除                    ✕   │
│                                  │
│  确定要删除「赛博朋克2077」吗？  │
│  此操作不可撤销。                │
│                                  │
│            [取消]    [删除]       │
└──────────────────────────────────┘
```

- shadcn `AlertDialog`
- 删除按钮: `Button` variant="destructive"

### 4.3 统计 (Statistics) — `/stats`

游戏时间数据可视化。

```
┌──────────────────────────────────────────────────────────┐
│  统计                                                    │
│                                                          │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐ │
│  │ ⏱ 总游戏时长│ │ 📋 总会话数 │ │ 🏆 最常玩的游戏     │ │
│  │             │ │             │ │                     │ │
│  │  486 小时   │ │   234 次    │ │   星露谷物语        │ │
│  │             │ │             │ │   200 小时          │ │
│  └─────────────┘ └─────────────┘ └─────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  每日游戏时间趋势 (AreaChart, 近 14 天)              │ │
│  │                                                      │ │
│  │       ╱╲                                             │ │
│  │      ╱  ╲     ╱╲                                     │ │
│  │  ───╱────╲───╱──╲───                                 │ │
│  │   02/01  02/03  02/05  02/07                         │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  游戏排行                                            │ │
│  │                                                      │ │
│  │  1. 星露谷物语     ████████████████████  200h  85次  │ │
│  │  2. 赛博朋克2077   █████████████        120h  64次  │ │
│  │  3. 艾尔登法环     ████████              80h  52次  │ │
│  │  4. 破晓传说       ████                  40h  33次  │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────┘
```

**组件细节**:

- **统计卡片**: 同仪表盘，3 列网格
  - 「最常玩的游戏」卡片额外显示游戏名 + 总时长
- **每日趋势图**: Recharts `<AreaChart>`
  - X 轴: 日期（近 14 天）
  - Y 轴: 每日游戏时长（小时）
  - 面积填充: `var(--primary)` opacity 0.2，线条 opacity 1
  - Tooltip: 悬停显示日期 + 精确时长
- **游戏排行**: 自定义列表组件
  - 每行: 排名序号 + 游戏名 + 进度条（相对占比）+ 总时长 + 会话数
  - 进度条: `bg-primary` 圆角条，宽度按比例计算（最大值 = 100%）
  - hover: `bg-muted/50` 高亮，**点击展开该游戏详情**

**游戏详情页** — `/stats/[game]` (点击排行中某游戏后):

```
┌──────────────────────────────────────────────────────────┐
│  ← 返回          星露谷物语                              │
│                                                          │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐ │
│  │ 总时长      │ │ 会话数      │ │ 近两周              │ │
│  │ 200 小时    │ │ 85 次       │ │ 12 小时             │ │
│  └─────────────┘ └─────────────┘ └─────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  游戏时间趋势 (LineChart, 近 14 天)                  │ │
│  │       ·                                              │ │
│  │      · ·     ·                                       │ │
│  │  ···    ···   ···                                    │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  会话历史                                            │ │
│  │  开始时间          │  结束时间          │  持续时间   │ │
│  │────────────────────┼────────────────────┼────────────│ │
│  │  02-07 20:00       │  02-07 22:30       │  2h 30m    │ │
│  │  02-06 18:00       │  02-06 18:45       │  0h 45m    │ │
│  │  02-05 21:00       │  02-06 02:10       │  5h 10m    │ │
│  └──────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────┘
```

- 返回按钮: Lucide `ArrowLeft` + 文字
- 趋势图: Recharts `<LineChart>` 带 dot markers
- 会话历史表: shadcn `Table`，按时间倒序，日期格式 `MM-DD HH:mm`

### 4.4 设置 (Settings) — `/settings`

全局应用设置。

```
┌──────────────────────────────────────────────────────────┐
│  设置                                                    │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  进程监控                                            │ │
│  │                                                      │ │
│  │  监控方式                                            │ │
│  │  ┌──────────────────┐                                │ │
│  │  │  ETW           ▼ │  ← Select (ETW / WMI)         │ │
│  │  └──────────────────┘                                │ │
│  │  ETW 提供更低延迟，但需要管理员权限                  │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌──────────────────────────────────────────────────────┐ │
│  │  启动行为                                            │ │
│  │                                                      │ │
│  │  启动时自动开始监控          ─────────── [  ●━━] ON  │ │
│  │  启动应用后立即开始监控游戏进程                      │ │
│  │                                                      │ │
│  │  ──────────────────────────────────────               │ │
│  │                                                      │ │
│  │  开机自动启动                ─────────── [━━●  ] OFF │ │
│  │  系统启动时自动运行 GameHelper                       │ │
│  │                                                      │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                          │
│                                         [保存设置]       │
└──────────────────────────────────────────────────────────┘
```

**组件细节**:

- 分组用 shadcn `Card`，每组有标题 (`CardHeader`) + 内容 (`CardContent`)
- **监控方式**: shadcn `Select` 组件，选项 ETW / WMI
  - 下方灰色说明文字: `text-sm text-muted-foreground`
- **开关设置**: 每项为一行 flex 布局
  - 左侧: 标题 (`font-medium`) + 说明 (`text-sm text-muted-foreground`)
  - 右侧: shadcn `Switch`
  - 项目间用 `Separator` 分隔
- **保存按钮**: 页面底部右对齐，`Button` variant="default"
  - 保存成功后显示 Toast: "设置已保存"

---

## 5. 通用组件规范

### Toast 通知
- 使用 shadcn `Sonner` (toast)
- 位置: 右下角
- 成功: 绿色图标 + 消息（"游戏已添加"、"设置已保存"）
- 错误: 红色图标 + 错误消息（"保存失败: ..."）
- 持续时间: 3 秒自动消失

### 加载状态
- 表格/列表: shadcn `Skeleton` 行占位
- 按钮提交: Button 内显示 `Loader2` 旋转图标 + 禁用状态
- 页面级: 内容区域居中显示 `Loader2` 旋转图标

### 空状态
- 统一风格: 居中图标 + 主标题 + 副标题（引导用户操作）
- 图标: Lucide 对应场景的 icon，`text-muted-foreground` 48px

---

## 6. 响应式断点

| 断点 | 宽度 | 布局变化 |
|---|---|---|
| `sm` | < 640px | 统计卡片单列堆叠，表格横向滚动 |
| `md` | < 768px | Sidebar 隐藏为 Sheet，内容全宽 |
| `lg` | ≥ 1024px | 完整 Sidebar + 内容区 |
| `xl` | ≥ 1280px | 内容区 max-width 限制，居中显示 |

---

## 7. 路由结构

```
/                → 仪表盘 (Dashboard)
/games           → 游戏库 (Game Library)
/stats           → 统计总览 (Statistics Overview)
/stats/[game]    → 单个游戏统计详情 (Game Detail)
/settings        → 设置 (Settings)
```
