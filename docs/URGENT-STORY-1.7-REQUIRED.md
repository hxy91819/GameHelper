# 🚨 紧急：Story 1.7 修复需求

**日期：** 2025-11-11  
**优先级：** 🔴 高（质量缺陷）  
**状态：** 待实施

---

## 快速摘要

Story 1.2 的 L2 模糊匹配存在严重缺陷，导致系统工具被错误匹配为游戏：
- ❌ `reg.exe` → `RE.exe` (92 分)
- ❌ `rg.exe` → `RE.exe` (83 分)

**影响：** 用户游戏时长数据被污染，统计不准确。

**解决方案：** Story 1.7 添加安全边界（路径验证、动态阈值、黑名单）。

---

## 关键文档

1. **Story 1.7 详细需求**  
   📄 `docs/stories/1.7.enhance-fuzzy-matching-safety.md`
   - 包含完整的验收标准
   - 详细的实现指导和代码示例
   - 全面的测试策略

2. **正式变更提案**  
   📄 `docs/sprint-change-proposal-story-1.7.md`
   - 问题分析和影响评估
   - 多个解决方案对比
   - 详细的实施计划和时间线

3. **受影响的 Story 1.2**  
   📄 `docs/stories/1.2.hybrid-matching-strategy.md`
   - 已更新状态标注需要修复
   - 添加了问题说明和修复方案引用

---

## 下一步行动

### 立即行动（用户）
- [ ] 审查 Story 1.7 需求文档
- [ ] 审查变更提案
- [ ] 批准修复方案
- [ ] 分配给 Dev Agent 实施

### 实施阶段（Dev Agent）
- [ ] 实现三个安全检查方法
- [ ] 更新 `TryMatchByMetadata` 方法
- [ ] 添加全面的单元测试
- [ ] 运行回归测试

### 验证阶段（QA Agent）
- [ ] 验证 `reg.exe` 和 `rg.exe` 不再误匹配
- [ ] 验证合法游戏仍然正常匹配
- [ ] 回归测试 Story 1.3-1.6
- [ ] 更新 QA Gate

---

## 预计工作量

| 阶段 | 时间 |
|------|------|
| 实施修复 | 4-6 小时 |
| 单元测试 | 2-3 小时 |
| 回归测试 | 4-8 小时 |
| 文档更新 | 1-2 小时 |
| **总计** | **11-19 小时** |

---

## 风险评估

**风险等级：** 🟡 中等

**主要风险：**
- Story 1.3-1.6 可能依赖错误匹配（概率低）
- 新验证逻辑可能引入新 bug（通过测试缓解）

**缓解措施：**
- 详细的回归测试计划
- 全面的单元测试覆盖
- 保持旧配置兼容性

---

## 联系人

- **Product Manager:** John
- **Dev Agent:** 待分配
- **QA Agent:** Quinn

---

**请尽快审查并批准，以便开始修复工作。**
